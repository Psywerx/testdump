
\chapter{Knjiznica in gradniki za Orange}

V okviru diplomske naloge smo razvili tri locene komponente za programerje in
koncne uporabnike programa Orange. 

Prva komponenta je programska knjiznica simple\_wbd, ki
omogoca enostaven dostop do programskega vmesnika indikatorjev in klimatskih
podatkov Svetovne banke. Ta knjiznica je narejena s cim manj odvisnosti in je 
namenjena splosni uporabi v python programih. Poudarka pri zasnovi knjiznice 
simple\_wbd sta predvsem enostavnost razsiritve in zanesljivost. Ta cilja
dosezemo z mehanizmom za vkljucevanje lastne kode v komponente knjiznice
in mehanizmi za popravljanje ali odstranjevanje pokvarjenih podatkov.

Drugi sestavni del je razsiritev knjiznice simple\_wbd s funkcionalnostmi, 
potrebnimi za lazje delo v programu Orange. To predvsem zavzema pretvorbo
pridobljenih podatkov v Orange in numpy tabele. Ta sklop je namenjen skriptnemu
delu s programom Orange in je dostopen kot api\_wrapper python modul. 

Tretji sestavni del je graficni vmesnik za uporabo api\_wrapper modula. Namen
graficnega vmesnika je omogociti ne-programerjem dostop do podatkov 
programskega vmesnika Svetovne banke znotraj programa Orange za namen obdelave,
analize in iskanja zakonitosti med podatki.

\section{Knjiznica simple\_wbd}

Knjiznica simple\_wbd programerjem olajsa dostop do podatkov programskega 
vmesnika Svetovne banke. Glavna lastnost te knjiznice je zdruzevanje vecjega 
stevila zahtev po podatkih in enostavna predstavitev dobljenih podatkov. 
Druga lastnost je pretvorba podatkov iz vec dimenzij v dvo-dimenzionalno polje,
primerno za uporabo v programu Orange. Glavna vmesnika te knjiznice sta 
IndicatorAPI in ClimateAPI. Prvi omogoca pridobivanje podatkov iz programskega 
vmesnika indikatorjev Svetovne banke, drugi pa s programskega vmesnika
podnebnih meritev.


%% % moznost razsiritve z dedovanjem dataset razreda.
%% % 
%% 
%% - omogoca pridobivanje vrednosti za filtre:
%%     - indicator api: drzave in agregati, indikatorji
%%     - climate api: drzave, tipi podatkov, meritveno obdobje 
%% 
%% - Zahteva za podatke vraca dataset objekt ki ponuja surove podatke, ali pa eno
%%   drugo obliko. 2D array ali pa dict.
%% 
%% - Dataset razred lahko tudi poljubno razsirimo.



\subsection{Pomocnik IndicatorAPI}

IndicatorAPI je razred namenjen pridobivanju podatkov indikatorjev razvoja.
Ker ima programski vmesnik Svetovne banke omejitev koliko podatkov lahko
prenesemo z eno poizvedbo, nam ta razred zdruzuje rezultate vseh poizvedb, ki
so potrebne za prenos celotne zahteve. To poskrbi tako da se po prvi poizvedbi
sprehodi cez stevilo preostalih strani (ref na basic response) ki so na voljo. 
Za razliko od obstojecih knjiznic\fnurl{https://pypi.python.org/pypi/wbdata}
\fnurl{https://pypi.python.org/pypi/wbpy/2.0.1} za delo z programskim vmesnikom
Svetovne banke, katerih cilj je cim bolj natancno predstaviti programski 
vmesnik, je cilj nase knjiznice le poenostaviti poizvedbe. V ta namen smo s to
knjiznico razsirili programski vmesnik da lahko z enim klicem funkcije 
prenesemo podatke tudi vec kot le enega indikatorja.

Poleg tega da skrbi za prenos vseh strani podatkov, tudi belezi stevilo 
narejenih in stevilo potrebnih poizvedb za celoten prenos. Do teh stevil lahko
dostopamo z drugih niti in jih uporabimo za prikaz napredka in preostalega
casa do prenosa celotne zahteve.

Glavne metode ki jih ponuja IndicatorAPI razred so:

\begin{description}  
\item [get\_indicators] vrne seznam vseh moznih indikatorjev z imeni, opisi in
      identifikatorji,
\item [get\_countries] vrne seznam drzav in regij z kodami in metapodatki,
\item [get\_dataset] vrne razred (IndicatorDataset) ki vsebuje vse podatke z 
      poizvedbe in metode za oblikovanje predstavitve podatkov: api\_responses,
      as\_list, as\_dict.
\end{description}



\subsubsection{Razred IndicatorDataset}

Razred IndikatorDataset je osnovni razred v katerem dobimo zahtevane podatke
indikatorjev. Ta razred vsebuje vse potrebne metode in podatke za predstavitev
rezultatov programskega vmesnika, na dva glavna nacina; kot slovar slovarjev in
dvo dimenzionalen seznam. Poleg omenjenih nacinov predstavitve podatkov lahko
dostopamo tudi do neobdelanih podatkov prejetih z programskega vmesnika za
vsako poizvedbo posebej.


Posamezne vrednosti teh podatkov so dolocene z drzavo, casovno komponento, in
kodo indikatorja. Te podatke lahko predstavimo na dva glavna nacina:

 - kot gnezdeni slovar, kjer je na prvem nivoju ime indikatorja, na drugem
   drzava, in na tretjem nivoju casovna komponenta.

 - Kot dvo-dimenzionalno polje, kjer imamo v vrsticah eno oznako, v stolpcih
   pa kartezicni produkt ostalih dveh. ponujene moznosti so:
   - vrstice = drzava, stolpci = cas x indikator
   - vrstice = cas, stolpci = drzava x indikator


Indicator



% notes:
% 3 dimenzije: cas, drzava, indikator > vrednost
% 
% lahko damo v:
% 
% 
%    \    drzava x indikator
%   cas
% 
%  ali: 
% 
%    \    cas x indikator
% drzava
% 




\subsection{Pomcnik ClimateAPI}

IndicatorAPI je 



% notes:
% 3 dimenzije: cas (decade,year,month), drzava, tip (pr/ tas)
% 
% lahko damo v poljubno konfiguracijo z nastetimi elementi v stolpcu
% 
% stolpci = [drzava, cas] => vrstice = tip ... naredi kartezicni produkt



\section{api\_wrapper}

% doda as orange table in as numpy obema indikator apiju in climate apiju.


razsiritev simple wbd vmesnikov z dedovanjem pravega dataset razreda.

\begin{verbatim}

class ClimateDataset(simple_wbd.ClimateDataset):
    
    def as_numpy(self):
        raise NotImplemented()
    
    def as_orange_table(self):
        raise NotImplemented()

class ClimateAPI(simple_wbd.ClimateAPI):

    def __init__(self):
        super().__init__(ClimateDataset)
\end{verbatim}





\section{Graficni vmesnik}


- Lazja uporaba.
- Vecja preglednost,
- lazje iskanje (text search filter)
